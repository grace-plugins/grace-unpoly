<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>Grace Unpoly Plugin 0.4.0-SNAPSHOT</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <div class="navHeader">
                
                <span id="logo">
                    <a href="https://graceframework.org" title="Go to Grace Framework Website">
                        <img src="../img/grace.svg" alt="Grace Framework" />
                    </a>
                </span>
                
                <div class="docHeader">
                    <h1 class="docTitle">Grace Unpoly Plugin</h1>
                    <h3 class="docSubTitle">Grace Plugin for using Grace with Unpoly</h3>
                    <span class="docVersion">0.4.0-SNAPSHOT</span>
                </div>
            </div>
            <div class="navLinks">
                <ul>
                    <li>
                        <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                            <a href="../guide/index.html" class="button">Table of contents</a>
                            <div id="nav-summary-childs" style="display:none;">
                                
                                <div class="toc-item" style="margin-left:0"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                                
                                <div class="toc-item" style="margin-left:0"><a href="#usage"><strong>2</strong><span>Usage</span></a></div>
                                
                            </div>
                        </div>
                    </li>
                    <li class="separator selected">
                        <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                    </li>
                    <li class="separator selected">
                        <a id="ref-button" href="../api/index.html">API Docs</a>
                    </li>
                </ul>

            </div>
        </div>

        <table id="colset" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>Grace Unpoly Plugin</h1>
                            <p><strong>Authors:</strong> Michael Yan</p>
                            <p><strong>Version:</strong> 0.4.0-SNAPSHOT</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#introduction"><strong>1</strong><span>Introduction</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#usage"><strong>2</strong><span>Usage</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="introduction"><a class="anchor" href="#introduction"></a>1 Introduction</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grace-plugins/grace-policy/edit/main/docs/guide/introduction.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>This is a plugin for using Grace/Grails app with <a href="https://unpoly.com">Unpoly.js</a>.</p>
</div>
<div class="sect3">
<h4 id="_whats_unpoly">What&#8217;s Unpoly?</h4>
<div class="paragraph">
<p>Unpoly is an unobtrusive Javascript framework for applications that render on the server. It allows your views to do things that are not normally possible in HTML, such as having links update only fragments of a page, or opening links in modal dialogs.</p>
</div>
<div class="paragraph">
<p>Unpoly can give your server-side application fast and flexible frontends that feel like a single-page application (SPA). It also preserves the resilience and simplicity of the server-side programming model.</p>
</div>
</div>


<h1 id="usage"><a class="anchor" href="#usage"></a>2 Usage</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grace-plugins/grace-policy/edit/main/docs/guide/usage.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Add dependency to the <code>build.gradle</code>,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">repositories {
    mavenCentral()
}

dependencies {
    implementation <span class="string"><span class="delimiter">&quot;</span><span class="content">org.graceframework.plugins:unpoly:VERSION</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Unpoly plugin supports controller-specific <code>withFormat()</code> method,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> {

    <span class="keyword">def</span> <span class="function">list</span>() {
        <span class="keyword">def</span> books = <span class="predefined-type">Book</span>.list()

        withFormat {
            unpoly {
                render(<span class="key">template</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>, <span class="key">model</span>: [<span class="key">bookList</span>: books])
            }
            json {
                render books <span class="keyword">as</span> JSON
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, this plugin supports extendsions for Grails Request and Response,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">// You can get unpoly request headers from Grails Request</span>

request.unpoly.version == request.getHeader(<span class="string"><span class="delimiter">'</span><span class="content">X-UP-Version</span><span class="delimiter">'</span></span>)
request.unpoly.target  == request.getHeader(<span class="string"><span class="delimiter">'</span><span class="content">X-UP-Target</span><span class="delimiter">'</span></span>)

<span class="comment">// Check Unpoly request?</span>
<span class="keyword">if</span> (request.unpoly <span class="keyword">as</span> <span class="type">boolean</span>) { <span class="comment">// or use request.isUnpoly()</span>
    template = <span class="string"><span class="delimiter">'</span><span class="content">book-detail</span><span class="delimiter">'</span></span>
}

<span class="comment">// You can set Unpoly response headers in Grails</span>

response.unpoly.target = <span class="string"><span class="delimiter">'</span><span class="content">.content</span><span class="delimiter">'</span></span>
response.unpoly.events = JsonOutput.toJson([[<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">itemDeleted</span><span class="delimiter">&quot;</span></span>]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use [<code>respond</code>](<a href="https://grails.github.io/legacy-grails-doc/4.0.0/ref/Controllers/respond.html" class="bare">https://grails.github.io/legacy-grails-doc/4.0.0/ref/Controllers/respond.html</a>) method introduced in Grails 2.3. The <code>respond</code> method tries to produce the most appropriate response for the requested content type (JSON, XML, HTML etc.)</p>
</div>
<div class="paragraph">
<p>You can [configure mime types](<a href="https://grails.github.io/legacy-grails-doc/4.0.0/guide/theWebLayer.html#contentNegotiation" class="bare">https://grails.github.io/legacy-grails-doc/4.0.0/guide/theWebLayer.html#contentNegotiation</a>) for Unpoly.</p>
</div>
<div class="paragraph">
<p>Update the <code>app/conf/application.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span class="key">grails</span>:
    <span class="key">mime</span>:
        <span class="key">types</span>:
            <span class="key">up</span>: <span class="string"><span class="content">text/html</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example given the show action:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">show</span>(<span class="predefined-type">Book</span> book) {
    respond book
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You could supply a <code>show.up.gsp</code> file to render the Unpoly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;div</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${book.id}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;h1&gt;</span>${book.title}<span class="tag">&lt;/h1&gt;</span>
    <span class="tag">&lt;p&gt;</span>${book.description}<span class="tag">&lt;/p&gt;</span>
<span class="tag">&lt;/div&gt;</span></code></pre>
</div>
</div>

                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            Copyright &copy; 2024-2025 Michael Yan. The content is licensed under a Creative Commons Attribution 4.0 International (CC BY SA 4.0) license.
            
        </div>

<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
